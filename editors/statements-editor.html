<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag & Drop Activity Creator - AI Inset Day</title>
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/statements-editor.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Loading screen -->
    <div class="loading-screen">
        <div class="loader"></div>
    </div>

    <!-- Header -->
    <header>
        <div id="header-placeholder" data-path="./js/header.js"></div>
    </header>

    <!-- Hero Section -->
    <section class="hero hero-medium">
        <div class="container hero-content">
            <h1>Drag & Drop Activity Creator</h1>
            <p>Design interactive learning experiences where students categorize statements by dragging them to appropriate columns. Perfect for exploring complex topics with multiple perspectives. Simply add your own content to the editor, preview to try it out and then export.</p>
        </div>
        <div class="floating-elements">
            <div class="floating-element element-1"></div>
            <div class="floating-element element-2"></div>
            <div class="floating-element element-3"></div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="section" style="padding-top: 30px;">
        <div class="container">
            <div class="tabs">
                <div class="tab active" data-tab="editor">Editor</div>
                <div class="tab" data-tab="preview">Preview</div>
                <div class="tab" data-tab="export">Export</div>
            </div>

            <div class="tab-content active" id="editor">
                <div class="card">
                    <h2 class="card-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg>
                        Activity Details
                    </h2>
                    <div class="input-group">
                        <label for="activityTitle">Activity Title</label>
                        <input type="text" id="activityTitle" value="AI Prompting: Effective vs. Ineffective Techniques">
                    </div>
                    <div class="column-settings">
                        <label>Use three columns</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="useThreeColumns">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
                        Columns Setup
                    </h2>
                    <div class="columns-editor" id="columnsEditor">
                        <div class="column-editor">
                            <div class="input-group">
                                <label for="column1Title">Column 1 Title</label>
                                <input type="text" id="column1Title" value="Effective Prompting">
                            </div>
                            <div class="input-group">
                                <label for="column1Color">Column Color</label>
                                <div class="color-picker">
                                    <input type="color" id="column1Color" value="#B4C6E7">
                                    <span id="column1ColorCode">#B4C6E7</span>
                                </div>
                            </div>
                        </div>
                        <div class="column-editor">
                            <div class="input-group">
                                <label for="column2Title">Column 2 Title</label>
                                <input type="text" id="column2Title" value="Ineffective Prompting">
                            </div>
                            <div class="input-group">
                                <label for="column2Color">Column Color</label>
                                <div class="color-picker">
                                    <input type="color" id="column2Color" value="#F4B5B5">
                                    <span id="column2ColorCode">#F4B5B5</span>
                                </div>
                            </div>
                        </div>
                        <div class="column-editor" id="column3Editor" style="display:none;">
                            <div class="input-group">
                                <label for="column3Title">Column 3 Title</label>
                                <input type="text" id="column3Title" value="Worth Discussing">
                            </div>
                            <div class="input-group">
                                <label for="column3Color">Column Color</label>
                                <div class="color-picker">
                                    <input type="color" id="column3Color" value="#B5F4B5">
                                    <span id="column3ColorCode">#B5F4B5</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
                        Statements
                    </h2>
                    <div class="statements-list" id="statementsList">
                        <!-- Statements will be added here dynamically -->
                    </div>
                    <button id="addStatement" class="btn btn-add">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        Add New Statement
                    </button>
                </div>
            </div>

            <div class="tab-content" id="preview">
                <div class="activity-header">
                    <h1 id="previewTitle">AI in Teaching: Good Practices vs. Concerns</h1>
                </div>

                <div class="activity-container">
                    <div class="statement-bank" id="previewStatementBank">
                        <h2>Drag each statement to the appropriate column</h2>
                        <!-- Preview statements will be added here -->
                    </div>

                    <div class="activity-columns" id="previewColumns">
                        <div class="drop-zone" id="previewColumn1">
                            <h2 id="previewColumn1Title">Effective AI Use</h2>
                        </div>
                        <div class="drop-zone" id="previewColumn2">
                            <h2 id="previewColumn2Title">Potential Misuse</h2>
                        </div>
                        <div class="drop-zone" id="previewColumn3" style="display:none;">
                            <h2 id="previewColumn3Title">Requires Discussion</h2>
                        </div>
                    </div>
                </div>

                <div class="controls">
                    <button id="checkAnswers" class="btn btn-primary">Check Answers</button>
                </div>
            </div>

            <div class="tab-content" id="export">
                <div class="card">
                    <h2 class="card-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                        Export Your Activity
                    </h2>
                    <p>Your activity is ready to export! Click the button below to download the HTML file.</p>
                    
                    <div class="export-options">
                        <button id="exportHTML" class="btn btn-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                            Download HTML File
                        </button>
                        
                        <button id="showCodeBtn" class="btn btn-neutral">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
                            View HTML Code
                        </button>
                        
                        <div id="codePanel" class="export-panel" style="display: none;">
                            <p>Copy and paste this code into a text editor and save it with a .html extension:</p>
                            <textarea id="exportCode" readonly></textarea>
                            <button id="copyCode" class="btn btn-neutral">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                                Copy Code
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div id="footer-placeholder" data-path="./js/footer.js"></div>
    </footer>

    <script>
        // Initial statements data
        const initialStatements = [
            { text: "Including specific details about your students' age group and ability levels", correct: "column1" },
            { text: "Using vague requests like 'Make a worksheet about fractions'", correct: "column2" },
            { text: "Uploading exam specifications or curriculum documents for context", correct: "column1" },
            { text: "Starting over with a new prompt if the first response isn't perfect", correct: "column2" },
            { text: "Writing naturally as if chatting with a colleague, without overthinking", correct: "column1" },
            { text: "Expecting the AI to understand specialized terminology without explanation", correct: "column2" },
            { text: "Providing specific formatting requirements and examples", correct: "column1" },
            { text: "Asking for revisions and refinements in follow-up messages", correct: "column1" }
        ];

        let statements = [...initialStatements];
        let draggingElement = null;
        let useThreeColumns = false;

        // Loading screen
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.querySelector('.loading-screen').classList.add('fade-out');
            }, 1000);
        });

        // Toggle three columns mode
        document.getElementById('useThreeColumns').addEventListener('change', function(e) {
            useThreeColumns = e.target.checked;
            
            // Show or hide column 3 editor
            document.getElementById('column3Editor').style.display = useThreeColumns ? 'block' : 'none';
            
            // Update statement radio options
            renderStatementsList();
            
            // Update the columns in the preview if it's active
            if (document.getElementById('preview').classList.contains('active')) {
                updatePreview();
            }
        });

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                const targetContent = document.getElementById(tab.dataset.tab);
                if (targetContent) {
                    targetContent.classList.add('active');
                    
                    if (tab.dataset.tab === 'preview') {
                        updatePreview();
                    } else if (tab.dataset.tab === 'export') {
                        generateExportCode();
                    }
                }
            });
        });

        // Navigation Smooth Scroll
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                
                // Switch to the relevant tab first
                document.querySelectorAll('.tab').forEach(t => {
                    if (t.dataset.tab === targetId) {
                        t.click();
                    }
                });
                
                window.scrollTo({
                    top: document.getElementById(targetId).offsetTop - 100,
                    behavior: 'smooth'
                });
            });
        });

        // Color pickers
        document.getElementById('column1Color').addEventListener('input', function(e) {
            document.getElementById('column1ColorCode').textContent = e.target.value;
            // Update preview if active
            if (document.getElementById('preview').classList.contains('active')) {
                updatePreview();
            }
        });

        document.getElementById('column2Color').addEventListener('input', function(e) {
            document.getElementById('column2ColorCode').textContent = e.target.value;
            // Update preview if active
            if (document.getElementById('preview').classList.contains('active')) {
                updatePreview();
            }
        });

        document.getElementById('column3Color').addEventListener('input', function(e) {
            document.getElementById('column3ColorCode').textContent = e.target.value;
            // Update preview if active
            if (document.getElementById('preview').classList.contains('active')) {
                updatePreview();
            }
        });

        // Function to get contrasting text color (black or white) based on background color
        function getContrastColor(hexcolor) {
            // If hexcolor has a # prefix, remove it
            if (hexcolor.startsWith('#')) {
                hexcolor = hexcolor.slice(1);
            }
            
            // Convert hex to RGB
            const r = parseInt(hexcolor.substr(0, 2), 16);
            const g = parseInt(hexcolor.substr(2, 2), 16);
            const b = parseInt(hexcolor.substr(4, 2), 16);
            
            // Calculate brightness
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            
            // Return white for dark backgrounds, black for light backgrounds
            return brightness > 128 ? '#000000' : '#FFFFFF';
        }

        // Initialize statements list
        function renderStatementsList() {
            const container = document.getElementById('statementsList');
            container.innerHTML = '';
            
            statements.forEach((statement, index) => {
                const statementEl = document.createElement('div');
                statementEl.className = 'statement-item';
                
                let radioOptions = `
                    <label class="radio-label">
                        <input type="radio" name="correct${index}" class="radio-input" value="column1" ${statement.correct === 'column1' ? 'checked' : ''}>
                        Column 1
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="correct${index}" class="radio-input" value="column2" ${statement.correct === 'column2' ? 'checked' : ''}>
                        Column 2
                    </label>
                `;
                
                if (useThreeColumns) {
                    radioOptions += `
                        <label class="radio-label">
                            <input type="radio" name="correct${index}" class="radio-input" value="column3" ${statement.correct === 'column3' ? 'checked' : ''}>
                            Column 3
                        </label>
                    `;
                }
                
                statementEl.innerHTML = `
                    <div class="statement-content">
                        <div class="input-group">
                            <label for="statement${index}">Statement</label>
                            <textarea id="statement${index}" rows="2">${statement.text}</textarea>
                        </div>
                        <div class="radio-group">
                            ${radioOptions}
                        </div>
                    </div>
                    <div class="statement-actions">
                        <button class="btn-delete" data-index="${index}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                        </button>
                    </div>
                `;
                container.appendChild(statementEl);
                
                // Add event listener for deleting a statement
                statementEl.querySelector('.btn-delete').addEventListener('click', function() {
                    deleteStatement(parseInt(this.dataset.index));
                });
                
                // Add event listeners for updating statement text and correct column
                const textArea = statementEl.querySelector(`#statement${index}`);
                textArea.addEventListener('input', function() {
                    statements[index].text = this.value;
                });
                
                const radioInputs = statementEl.querySelectorAll(`input[name="correct${index}"]`);
                radioInputs.forEach(input => {
                    input.addEventListener('change', function() {
                        statements[index].correct = this.value;
                    });
                });
            });
        }

        // Add new statement
        document.getElementById('addStatement').addEventListener('click', function() {
            statements.push({
                text: "New statement",
                correct: "column1"
            });
            renderStatementsList();
        });

        // Delete statement
        function deleteStatement(index) {
            statements.splice(index, 1);
            renderStatementsList();
        }

        // Update preview
        function updatePreview() {
            const titleEl = document.getElementById('previewTitle');
            const column1TitleEl = document.getElementById('previewColumn1Title');
            const column2TitleEl = document.getElementById('previewColumn2Title');
            const column3TitleEl = document.getElementById('previewColumn3Title');
            const column3El = document.getElementById('previewColumn3');
            
            if (titleEl) titleEl.textContent = document.getElementById('activityTitle').value;
            if (column1TitleEl) column1TitleEl.textContent = document.getElementById('column1Title').value;
            if (column2TitleEl) column2TitleEl.textContent = document.getElementById('column2Title').value;
            
            // Get column colors for styling
            const column1Color = document.getElementById('column1Color').value;
            const column2Color = document.getElementById('column2Color').value;
            const column3Color = document.getElementById('column3Color').value;
            
            // Show/hide column 3 based on the toggle
            if (column3El) {
                column3El.style.display = useThreeColumns ? 'block' : 'none';
                if (column3TitleEl) column3TitleEl.textContent = document.getElementById('column3Title').value;
            }
            
            // Update statement bank
            const statementBank = document.getElementById('previewStatementBank');
            if (statementBank) {
                // Keep the heading
                statementBank.innerHTML = '<h2>Drag each statement to the appropriate column</h2>';
                
                // Add statements
                statements.forEach(statement => {
                    const statementEl = document.createElement('div');
                    statementEl.className = 'statement';
                    statementEl.setAttribute('draggable', 'true');
                    statementEl.setAttribute('data-correct', statement.correct);
                    statementEl.textContent = statement.text;
                    statementBank.appendChild(statementEl);
                });
                
                // Reset drop zones with background colors set
                if (document.getElementById('previewColumn1')) {
                    document.getElementById('previewColumn1').innerHTML = `<h2>${document.getElementById('column1Title').value}</h2>`;
                    document.getElementById('previewColumn1').style.backgroundColor = column1Color;
                }
                if (document.getElementById('previewColumn2')) {
                    document.getElementById('previewColumn2').innerHTML = `<h2>${document.getElementById('column2Title').value}</h2>`;
                    document.getElementById('previewColumn2').style.backgroundColor = column2Color;
                }
                if (document.getElementById('previewColumn3')) {
                    document.getElementById('previewColumn3').innerHTML = `<h2>${document.getElementById('column3Title').value}</h2>`;
                    document.getElementById('previewColumn3').style.backgroundColor = column3Color;
                }
                
                // Set up drag and drop for preview
                setupDragAndDrop();
            }
        }

        // Setup drag and drop for preview
        function setupDragAndDrop() {
            document.querySelectorAll('#preview .statement').forEach(statement => {
                statement.addEventListener('dragstart', e => {
                    draggingElement = e.target;
                    e.target.classList.add('dragging');
                });

                statement.addEventListener('dragend', e => {
                    e.target.classList.remove('dragging');
                    draggingElement = null;
                });
            });

            document.querySelectorAll('#preview .drop-zone').forEach(dropZone => {
                dropZone.addEventListener('dragover', e => {
                    e.preventDefault();
                    // Just add a highlight effect during dragover
                    dropZone.style.boxShadow = '0 0 10px rgba(0,0,0,0.3)';
                });

                dropZone.addEventListener('dragleave', e => {
                    // Remove highlight effect
                    dropZone.style.boxShadow = '';
                });

                dropZone.addEventListener('drop', e => {
                    e.preventDefault();
                    // Remove highlight effect
                    dropZone.style.boxShadow = '';
                    
                    if (draggingElement) {
                        dropZone.appendChild(draggingElement);
                    }
                });
            });
        }

        // Check answers in preview
        document.getElementById('checkAnswers').addEventListener('click', function() {
            document.querySelectorAll('#preview .statement').forEach(statement => {
                statement.classList.remove('correct', 'incorrect');
                const parentZone = statement.parentElement;
                
                if (parentZone.id === 'previewColumn1' && statement.dataset.correct === 'column1' ||
                    parentZone.id === 'previewColumn2' && statement.dataset.correct === 'column2' ||
                    parentZone.id === 'previewColumn3' && statement.dataset.correct === 'column3') {
                    statement.classList.add('correct');
                } else if (parentZone.classList.contains('drop-zone')) {
                    statement.classList.add('incorrect');
                }
            });
        });

        // Generate exported HTML
        function generateExportCode() {
            const activityTitle = document.getElementById('activityTitle').value;
            const column1Title = document.getElementById('column1Title').value;
            const column2Title = document.getElementById('column2Title').value;
            const column1Color = document.getElementById('column1Color').value;
            const column2Color = document.getElementById('column2Color').value;
            
            // Only include column 3 if enabled
            let column3Title = '';
            let column3Color = '';
            if (useThreeColumns) {
                column3Title = document.getElementById('column3Title').value;
                column3Color = document.getElementById('column3Color').value;
            }
            
            // Use standard text colors for column titles (not based on background)
            
            let statementsHTML = '';
            statements.forEach(statement => {
                statementsHTML += `            <div class="statement" draggable="true" data-correct="${statement.correct}">${statement.text}</div>\n`;
            });
            
            // Generate drop zones HTML with background colors
            let dropZonesHTML = `
            <div class="drop-zone" id="column1" style="background-color: ${column1Color};">
                <h2>${column1Title}</h2>
            </div>
            <div class="drop-zone" id="column2" style="background-color: ${column2Color};">
                <h2>${column2Title}</h2>
            </div>`;
            
            if (useThreeColumns) {
                dropZonesHTML += `
            <div class="drop-zone" id="column3" style="background-color: ${column3Color};">
                <h2>${column3Title}</h2>
            </div>`;
            }

            // Prepare CSS for columns
            let columnsCSS = `
        .columns {
            display: grid;
            grid-template-columns: repeat(${useThreeColumns ? '3' : '2'}, 1fr);
            gap: 1rem;
        }`;
            
            // Dragover effect for columns
            let dragoverCSS = `
        .drop-zone.dragover {
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }`;
            
            // Additional CSS for column 3 if needed
            let column3CSS = useThreeColumns ? `
            --green-soft: ${column3Color};
            --green-hover: ${adjustColor(column3Color, -20)};` : '';
            
            // Create media query adjustment for three columns if needed
            let mediaQueryCSS = `
        @media (max-width: 768px) {
            .columns {
                grid-template-columns: 1fr;
            }
        }`;

            // Add column3 to check answers function if needed
            let checkAnswersColumnCondition = `
                if (parentZone.id === statement.dataset.correct) {
                    statement.classList.add('correct');
                } else if (parentZone.classList.contains('drop-zone')) {
                    statement.classList.add('incorrect');
                }`;
            
            const htmlCode = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${activityTitle}</title>
    <style>
        :root {
            --blue-soft: ${column1Color};
            --blue-hover: ${adjustColor(column1Color, -20)};
            --red-soft: ${column2Color};
            --red-hover: ${adjustColor(column2Color, -20)};${column3CSS}
            --success: #90EE90;
            --error: #FFB6C1;
            --neutral: #F0F4F8;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: #FAFAFA;
        }

        .header {
            background-color: white;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            margin: 0;
            color: #2C3E50;
            font-size: 1.875rem;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .statement-bank {
            background: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
${columnsCSS}

        .drop-zone {
            background: white;
            padding: 1.5rem;
            border-radius: 0.5rem;
            min-height: 400px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: all 0.2s ease;
        }

        .drop-zone h2 {
            margin-top: 0;
            font-size: 1.25rem;
            text-align: center;
        }

        .statement {
            background: var(--neutral);
            padding: 1rem;
            margin: 0.75rem 0;
            border-radius: 0.375rem;
            cursor: move;
            transition: all 0.2s;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .statement:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .statement.dragging {
            opacity: 0.5;
        }

        .statement.correct {
            background: var(--success);
        }

        .statement.incorrect {
            background: var(--error);
        }
${dragoverCSS}

        .controls {
            text-align: center;
            margin: 2rem 0;
        }

        button {
            background: linear-gradient(135deg, var(--blue-soft), var(--red-soft));
            color: #2C3E50;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
            font-weight: 500;
        }

        button:hover {
            transform: translateY(-1px);
        }
${mediaQueryCSS}
    </style>
</head>
<body>
    <header class="header">
        <h1>${activityTitle}</h1>
    </header>

    <div class="container">
        <div class="statement-bank" id="statement-bank">
            <h2>Drag each statement to the appropriate column</h2>
${statementsHTML}
        </div>

        <div class="columns">
${dropZonesHTML}
        </div>
    </div>

    <div class="controls">
        <button onclick="checkAnswers()">Check Answers</button>
    </div>

    <script>
        let draggingElement = null;

        document.querySelectorAll('.statement').forEach(statement => {
            statement.addEventListener('dragstart', e => {
                draggingElement = e.target;
                e.target.classList.add('dragging');
            });

            statement.addEventListener('dragend', e => {
                e.target.classList.remove('dragging');
                draggingElement = null;
            });
        });

        document.querySelectorAll('.drop-zone').forEach(dropZone => {
            dropZone.addEventListener('dragover', e => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });

            dropZone.addEventListener('dragleave', e => {
                dropZone.classList.remove('dragover');
            });

            dropZone.addEventListener('drop', e => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                
                if (draggingElement) {
                    dropZone.appendChild(draggingElement);
                }
            });
        });

        function checkAnswers() {
            document.querySelectorAll('.statement').forEach(statement => {
                statement.classList.remove('correct', 'incorrect');
                const parentZone = statement.parentElement;
                ${checkAnswersColumnCondition}
            });
        }
    <\/script>
</body>
</html>`;
            
            document.getElementById('exportCode').value = htmlCode;
            // Store for export
            window.exportedHTML = htmlCode;
        }

        // Show/hide code panel
        document.getElementById('showCodeBtn').addEventListener('click', function() {
            const codePanel = document.getElementById('codePanel');
            if (codePanel.style.display === 'none') {
                codePanel.style.display = 'block';
                this.textContent = 'Hide HTML Code';
            } else {
                codePanel.style.display = 'none';
                this.textContent = 'View HTML Code';
            }
        });

        // Copy code to clipboard
        document.getElementById('copyCode').addEventListener('click', function() {
            const codeTextarea = document.getElementById('exportCode');
            codeTextarea.select();
            document.execCommand('copy');
            this.textContent = 'Copied!';
            setTimeout(() => {
                this.textContent = 'Copy Code';
            }, 2000);
        });

        // Export HTML file
        document.getElementById('exportHTML').addEventListener('click', function() {
            generateExportCode();
            const blob = new Blob([window.exportedHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = document.getElementById('activityTitle').value.replace(/\s+/g, '-').toLowerCase() + '.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // Utility function to adjust color brightness
        function adjustColor(color, amount) {
            // Remove # if present
            color = color.replace(/#/g, '');
            
            // Parse the color
            let r = parseInt(color.substring(0, 2), 16);
            let g = parseInt(color.substring(2, 4), 16);
            let b = parseInt(color.substring(4, 6), 16);
            
            // Adjust each color component
            r = Math.max(0, Math.min(255, r + amount));
            g = Math.max(0, Math.min(255, g + amount));
            b = Math.max(0, Math.min(255, b + amount));
            
            // Convert back to hex
            return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;
        }

        // Initialize
        renderStatementsList();
    </script>
    <script src="../js/header.js"></script>
    <script src="../js/footer.js"></script>
</body>
</html>