<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <!-- Default doc + helpful MIME types -->
    <defaultDocument>
      <files>
        <clear />
        <add value="index.html" />
      </files>
    </defaultDocument>
    <staticContent>
      <remove fileExtension=".json" />
      <mimeMap fileExtension=".json" mimeType="application/json" />
      <remove fileExtension=".webmanifest" />
      <mimeMap fileExtension=".webmanifest" mimeType="application/manifest+json" />
    </staticContent>
    <!-- === Maintenance Mode Toggle ==========================================
         Flip enabled="true|false" in the rule below to turn
         maintenance ON or OFF for these routes:
           - /        (root)
           - /index.html
           - /resources/ideas.html
           - /resources/prompt-library.html
         ==================================================================== -->
    <rewrite>
      <rules>
        <rule name="MaintenanceMode" enabled="false" stopProcessing="true">
          <match url="^$|^index\.html$|^resources/(ideas|prompt\-library)\.html$" />
          <action type="Redirect" url="/maintenance.html" appendQueryString="false" redirectType="Found" />
        </rule>
      </rules>
    </rewrite>
  </system.webServer>

  <!-- Never cache index.html -->
  <location path="index.html">
    <system.webServer>
      <httpProtocol>
        <customHeaders>
          <add name="Cache-Control" value="no-store, no-cache, must-revalidate" />
          <add name="Pragma" value="no-cache" />
          <add name="Expires" value="0" />
        </customHeaders>
      </httpProtocol>
    </system.webServer>
  </location>

  <!-- Cache static assets aggressively for 30 days (adjust path as needed) -->
  <location path="assets">
    <system.webServer>
      <staticContent>
        <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="30.00:00:00" />
      </staticContent>
    </system.webServer>
  </location>
  <location path="css">
    <system.webServer>
      <staticContent>
        <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="30.00:00:00" />
      </staticContent>
    </system.webServer>
  </location>
  <location path="js">
    <system.webServer>
      <staticContent>
        <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="30.00:00:00" />
      </staticContent>
    </system.webServer>
  </location>
  
</configuration>
